# 因子模型

因子模型是一种假设，资产的收益可以分解为一组因子的线性组合，这些因子可能代表宏观经济变量、行业特征或其他系统性风险因素，以及资产本身的特定噪声项。

## 单因子模型

把经济系统中所有相关因素作为一个总的宏观经济指数。

对时间 $t$ 的任何证券 $i$ 有时间序列
$$r_{it}=a_{i}+b_{i}f_{t}+e_{it}$$
- $r_{it}$ ：$t$ 时期回报
- $a_i$：零因子，资产的超额收益
- $f_t$：在 t 时期公共因子的预测值
- $b_i$：证券$i$对公共因子$f$的敏感度（因子载荷）
- $e_{it}$：非系统性风险

单因子模型的假设：
- 因子与随机扰动向相互独立
- 无异质性

## 多因子模型

### 两因子模型

$$r_{i}=a_{i}+b_{i1}f_{1}+b_{i2}f_{2}+e_{i}$$
其中
$$E(e_i)=0\quad\text{Cov}(e_i,e_j)=0\quad \text{Cov}(e_i,f_1)=0\quad\text{Cov}(e_i,f_2)=0$$
在两因子模型下，对于证券 i，其回报率均值：
$$\bar{r_{i}} =a_{i}+b_{i1}\bar{f_{1}} +b_{i2}\bar{f_{2}}$$
方差：
$$
\sigma_{i} =b_{i1}^{2}\sigma_{f_{1}}^{2} +b_{i2}^{2}\sigma_{f_{2}}^{2} +2b_{i1}b_{i2}\text{Cov} \left( f_{1},f_{2} \right)+\sigma_{ei}^{2}
$$
协方差：
$$\sigma_{ij}=b_{i1}b_{j1}\sigma_{f1}^{2}+b_{i2}b_{j2}\sigma_{f2}^{2}+(b_{i1}b_{j2}+b_{i2}b_{j1})\mathrm{Cov}(f_{1},f_{2})$$

# APT


## 套利方法

- 当前时刻净支出为0，将来收益为正
- 当前收益为正，将来净支出为0

假设投资者构造这样的资产组合： 无风险利率借入1元钱；1元钱投资在两种资产，这样构造一个自融资组合。 




## 套利组合

- 无需追加投资：$\sum w_{i}=0$
- 不会增加风险：$\sum w_{i}b_{i}=0$
- 预期收益为正：$\sum w_{i}r_{i}>0$
==注意：w可正可负==

无套利状态下的资产收益率（也可以理解为套利的最终状态）：
对于任何资产组合$(w_1,w_2,w_3)$在均衡状态下满足：
$$
\begin{cases}w_{1}+w_{2}+w_{3}=0&\\ b_1w_1+b_2w_{2}+b_{3}w_{3}=0&\\ w_{1}\bar{r_{1}} +w_{2}\bar{r_{2}} +w_{3}\bar{r_{3}} =0&\end{cases}
$$
则必然存在常数$\lambda_0, \lambda_1$，使得：
$$\bar{r_{i}} =\lambda_{0} +\lambda_{1} b_{i},\quad i=1,2,3$$

假设 n 种资产收益率由 m 个因子决定，那么套利即是一个最优化问题：
$$
\max_{w} \sum_{i=1}^{n} w_{i}\bar{r_{i}} \quad s.t.\begin{cases}\sum_{i=1}^{n} w_{i}=0&\\ \sum_{i=1}^{n} w_{i}b_{ij}=0&j=1,2,\cdots m\end{cases}
$$
使用 Lagrange 乘子法可得出，当收益率最大时：
$$
\bar{r_{i}} =\lambda_{0} +\sum_{j=1}^{m} b_{ij}\lambda_{j}
$$
此时可以看到，若$b_{ij}=0$，则该资产为无风险资产，$\lambda_0=r_f$。

此时若调整为单因子模型的条件 $\bar{r_{i}} =\lambda_{0} +\lambda_{1} b_{i},\quad i=1,2,\cdots,n$
则对所有风险资产有：
$$
\lambda_{1} =\frac{\bar{r_{1}} -r_{f}}{b_{1}} =\frac{\bar{r_{2}} -r_{f}}{b_{2}} =\cdots =\frac{\bar{r_{m}} -r_{f}}{b_{n}}
$$
### 无套利状态下收益的风险线性关系推导

现有两资产$i$和资产$j$，设无风险利率为$\lambda_0$，现以该利率借入 1 单位，并用于投资$i,j$。（满足无追加投资）

假设两个资产的收益都仅取决于公共因子 $f$，则可描绘 $i,j$ 的收益（忽略残差）：$R_i=\bar{r_i}+b_if \quad R_j=\bar{r_j}+b_jf$

在因子模型的假定下，套利组合的收益为
$$
r_p = wR_i+(1-w)R_j-\lambda_0
$$
代入单因子模型表达式得：
$$
r_p = \left[w(\bar{r_i}+b_if) \right] + \left[(1-w)(\bar{r_j}+b_jf) \right]-\lambda_0
$$
展开并合并：
$$
r_p = [w(\overline{r}_{i}-\overline{r}_{j})+\overline{r}_{j}-\lambda_{0}]+[w(b_{i}-b_{j})+b_{j}]f
$$
此时形成了一个新的单因子模型结构，风险因子敏感性为 $w(b_{i}-b_{j})+b_{j}$。**因为套利组合无风险，因此风险因子敏感性为 0**，此时：
$$
w^{\ast} = -\frac{b_j}{b_i-b_j}
$$
此时若不存在套利，即套利组合收益为 0 ，即：
$$
r_p=-\frac{b_j}{b_i-b_j}(\overline{r}_i-\overline{r}_j)+\overline{r}_j-\lambda_0=0
$$
整理得到等式：
$$
\begin{gathered}b_{i}\left( \bar{r_{j}} -\lambda_{0} \right) =b_{j}\left( \bar{r_{i}} -\lambda_{0} \right)\\ \frac{\bar{r_{i}} -\lambda_{0}}{b_{i}} =\frac{\bar{r_{j}} -\lambda_{0}}{b_{j}}\end{gathered}
$$
令等号两边的值为$\lambda_1$：
$$
\frac{\bar{r_{i}} -\lambda_{0}}{b_{i}} =\frac{\bar{r_{j}} -\lambda_{0}}{b_{j}}=\lambda_1
$$
可得无套利状态下收益的风险线性关系：
$$
\bar{r_n}=\lambda_0+b_n\lambda_1 \quad n=i,j
$$

# APT 的另一种表达

在单因子模型下，如果由一贯资产组合p，使 $b_p=1$即：
$$\bar{r_p}=r_f+\lambda_1$$
则有$\lambda_1 = \bar{r_p}-r_f$，该组合称为纯因子组合

>[!Note]
>可以把纯因子组合看作是专注于某一因子的“测试组合”，它完全跟踪该因子的表现，而与其他特质风险无关。这在多因子模型或风险分析中非常有用，因为它能将因子收益的来源与其他风险分离开来。


# 例题

**【例题一】** 假定市场可以用下面的三种系统风险及相应的风险溢价进行描述

| 要素       | 风险溢价 |
| -------- | ---- |
| 工业生产（I）  | 6%   |
| 利率（R）    | 2%   |
| 消费者信心（C） | 4%   |
特定股票的收益率可以用下面的方程来确定
$r=15\%+1.0I+0.5R+0.75C+e$

**若无风险利率为6%，使用套利定价理论确定该股票的均衡收益率。**
$$\begin{aligned}\overline{r}&=r_{f}+1.0\lambda_{I}+0.5\lambda_{R}+0.75\lambda_{c}\\&=6\%+1\times6\%+0.5\times2\%+0.75\times4\%\\&=16\%\end{aligned}$$

**该股票价格是低估还是高估了？解释原因。**

当其他系统风险要素影响因子均为 0 的时候，得到的预期收益率（无风险）为 15%，而均衡收益率（有风险状态）为 16%，有风险收益率高于无风险，说明该股票定价过高，市场存在套利，无套利收益率为 16%。

**【例题二】** 假设影响投资收益率的只有一个因素，A、B、C三个组合都是充分分散的投资组合，预期收益率分别为24％、8％、14％，因素敏感度分别等于1.2、0.0和0.6。某投资者现持有A、B、C三个组合的市值均为500万，其投资组合总价值为1500万。请问该投资者有无套利机会？如果有，应如何套利（请给出一个具体的套利组合及套利收益）？

==判断无套利条件下的一致性==

易知 B 为无风险资产，故$R_f=R_B=8\%$
此时计算 A 与 C 在无套利情况下的定价：
$\bar{R_A}=8\%+1.2\times(24\%-8\%)=27.2\%$
$\bar{R_C}=8\%+0.6\times(14\%-8\%)=11.6\%$
A的均衡收益率高于预期收益率，C 的均衡收益率低于预期收益率，所以 A 被低估，C 被高估，存在套利机会。

==构造套利组合==

由上可知，套利操作应为卖出 C 并买入 A。

现在$w_A=1/3$，假设其不变。
根据 $1.2\times w_A+0\times w_B+0.6 \times w_C=0$，求得$w_C=-2w_A=-2/3$，此时又根据$w_A+w_B+w_C=0$得出$w_B=1/3$

所以组合为：卖空 C 1000 万，买入 A 和 B 各 500 万。

A期末期望值：500万 × (1+24%) = 620万
B期末期望值：500万 × (1+8%) = 540万
C需回补空头：-1000万（卖空时获得5百万现金），C上涨14%，需以1000万×(1+14%)=1140万买回。

最终收益：620+540-1140=20万










